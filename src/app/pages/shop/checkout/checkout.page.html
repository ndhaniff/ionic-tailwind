<ion-header mode="ios">
  <ion-toolbar>
    <ion-title>Checkout</ion-title>
    <ion-buttons>
        <ion-back-button slot="start" text=""></ion-back-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
    <div class="wrapper p-6">
        <div class="text-lg pb-2 border-b flex items-center justify-between">Delivery Address <ion-icon color="default" name="create-outline"></ion-icon></div>
        <div *ngIf="customerDetail && customerDetail.shipping_address as sa; else noaddress">
            <div class="text-sm pt-2">
                {{sa.street1}} {{sa.street2}}, <br>
                {{sa.city}}, {{sa.poscode}} {{sa.state}}<br>
            </div>
        </div>
        <ng-template #noaddress>
            <div class="p-4 text-center text-xs">You have not yet set up a shipping address</div>
            <div (click)="editAddress()" class="underline text-primary text-center text-xs">Edit address</div>
        </ng-template>
        <div class="my-4 mail-border"></div>
        <div *ngIf="cartState">
            <div *ngFor="let prod of cartState.cart">
                <div class="shop mb-4 mt-2 py-4 border-b">
                    <div class="text-lg py-4 uppercase border-b font-bold flex items-center"><svg class="mr-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M21 13.242V20h1v2H2v-2h1v-6.758A4.496 4.496 0 0 1 1 9.5c0-.827.224-1.624.633-2.303L4.345 2.5a1 1 0 0 1 .866-.5H18.79a1 1 0 0 1 .866.5l2.702 4.682A4.496 4.496 0 0 1 21 13.242zm-2 .73a4.496 4.496 0 0 1-3.75-1.36A4.496 4.496 0 0 1 12 14.001a4.496 4.496 0 0 1-3.25-1.387A4.496 4.496 0 0 1 5 13.973V20h14v-6.027zM5.789 4L3.356 8.213a2.5 2.5 0 0 0 4.466 2.216c.335-.837 1.52-.837 1.856 0a2.5 2.5 0 0 0 4.644 0c.335-.837 1.52-.837 1.856 0a2.5 2.5 0 1 0 4.457-2.232L18.21 4H5.79z"/></svg> {{prod[0]}}</div>
                    <div class="product-list my-4">
                        <div class="product" *ngFor="let p of prod[1]">
                            <ion-item lines="none">
                                <div slot="start" style="width:80px;height:80px">
                                    <img [src]="p.images[0]" alt="">
                                </div>
                                <div>
                                    <div class="text-sm font-bold">{{p.name}}</div>
                                    <div class="text-xs text-gray-500">RM {{p.price}}</div>
                                </div>
                                <div slot="end">
                                    x {{p.count}}
                                </div>
                            </ion-item>
                        </div>
                    </div>
                    <div class="my-4  px-4 border-t rounded-md  border-b border-teal-300 bg-teal-100">
                        <div class="py-2 border-b flex items-center justify-between"><span class="text-primary ">Shipping Option</span> <ion-icon (click)="presentActionSheet()" color="default" name="create-outline"></ion-icon></div>
                        <div class="font-bold pt-2">Standard Delivery</div>
                        <div class="courier py-4 ">
                            <div class="text-semibold pb-2 flex items-center justify-between">{{courier.name}} <span>RM {{courier.price}} ></span></div>
                            <div class="text-sm">Received by {{deliveryDate}}</div>
                            <div class="text-xs">(Please ensure your checkout address is deliverable)</div>
                        </div>
                    </div>

                    <div class="fixed bg-white border-t shadow-inner w-full bottom-0 left-0">
                        <div class="flex items-center justify-end">
                            <div class="flex items-center w-3/4">
                                <div class="flex-1 mr-3">
                                    <div class="text-xs">Total Payment</div>
                                    <div class="text-xl font-bold text-primary">RM {{cartState.totals.grandTot + courier.price}}</div>
                                </div>
                                <div (click)="placeOrder()" class="bg-primary p-4 text-white">Place Order</div>
                            </div>
                        </div>
                    </div>

                    <div class="my-4 flex justify-between px-4">
                        Payment Option: <span>Bank Transfer</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</ion-content>
